<!DOCTYPE html>
<html lang="cs">
<head>
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <meta charset="UTF-8">
  <title>Rosniƒçka Dashboard</title>
  <style>
    body {
      margin: 0;
      background: #1e1e2f;
      overflow: hidden;
      color: white;
      font-family: sans-serif;
    }

    .rain {
      position: absolute;
      width: 2px;
      height: 20px;
      background: #00bfff;
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% { top: -20px; }
      100% { top: 100vh; }
    }

    .lightning {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      opacity: 0;
      animation: flash 0.2s ease-in-out;
    }

    @keyframes flash {
      0% { opacity: 0.8; }
      100% { opacity: 0; }
    }

    .sun {
      position: absolute;
      top: 50px;
      right: 50px;
      width: 80px;
      height: 80px;
      background: radial-gradient(circle, #ff0, #ffa500);
      border-radius: 50%;
      animation: pulse 3s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }

    .cloud {
      position: absolute;
      top: 100px;
      left: 50px;
      width: 120px;
      height: 60px;
      background: #ccc;
      border-radius: 50%;
      animation: drift 20s linear infinite;
    }

    @keyframes drift {
      0% { left: -150px; }
      100% { left: 100vw; }
    }

    #weather {
      position: relative;
      z-index: 1;
    }

    #forecast {
      position: absolute;
      bottom: 10px;
      left: 10px;
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
    }
  </style>
</head>
<body>

<div id="weather"></div>
<div id="forecast">Naƒç√≠t√°m p≈ôedpovƒõƒè...</div>

<script>
function setRainIntensity(level) {
  const weather = document.getElementById('weather');
  weather.innerHTML = ''; // Vyƒçistit p≈ôedchoz√≠ kapky

  const drops = Math.floor(level); // 0‚Äì100
  for (let i = 0; i < drops; i++) {
    const drop = document.createElement('div');
    drop.className = 'rain';
    drop.style.left = Math.random() * window.innerWidth + 'px';
    drop.style.animationDuration = (Math.random() * 1 + 0.5) + 's';
    weather.appendChild(drop);
  }
}

function showLightning() {
  const flash = document.createElement('div');
  flash.className = 'lightning';
  document.body.appendChild(flash);
  setTimeout(() => flash.remove(), 200);
}

function showSun() {
  const sun = document.createElement('div');
  sun.className = 'sun';
  document.body.appendChild(sun);
}

function showClouds() {
  for (let i = 0; i < 3; i++) {
    const cloud = document.createElement('div');
    cloud.className = 'cloud';
    cloud.style.top = (100 + i * 60) + 'px';
    cloud.style.animationDelay = (i * 5) + 's';
    document.body.appendChild(cloud);
  }
}

function showRainClouds() {
  showClouds();
}

// üîë Zadej sv≈Øj API kl√≠ƒç zde:
const apiKey = "c71393f64c126e61776f5d26561d0f8b";
const lat = 50.0755; // Praha
const lon = 14.4378;

fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric&lang=cz`)
  .then(res => res.json())
  .then(data => {
    const now = data.list[0];
    const next5h = data.list.slice(0, 2); // 5h dop≈ôedu

    const condition = now.weather[0].main.toLowerCase();
    const rainLevel = now.rain ? now.rain["3h"] * 10 : 0;

    setRainIntensity(rainLevel);

    if (condition.includes("thunderstorm")) {
      setInterval(showLightning, Math.random() * 3000 + 2000);
    }

    if (condition.includes("clear")) {
      showSun();
    } else if (condition.includes("clouds")) {
      showClouds();
    } else if (condition.includes("rain")) {
      showRainClouds();
    }

    // Zobrazit p≈ôedpovƒõƒè
    const forecastDiv = document.getElementById('forecast');
    forecastDiv.innerHTML = "<strong>P≈ôedpovƒõƒè na 5 hodin:</strong><br>";
    next5h.forEach(e => {
      const ƒças = e.dt_txt.split(" ")[1].slice(0,5);
      const stav = e.weather[0].description;
      const d√©≈°≈• = e.rain ? e.rain["3h"] : 0;
      forecastDiv.innerHTML += `${ƒças} ‚Äì ${stav}, d√©≈°≈•: ${d√©≈°≈•} mm<br>`;
    });
  })
  .catch(err => {
    document.getElementById('forecast').innerText = "Chyba p≈ôi naƒç√≠t√°n√≠ dat.";
    console.error(err);
  });
</script>

</body>
</html>
